# Сервис Rich Tracker

Сервис **Rich Tracker** предназначен для отслеживания блоков с рич-контентом на маркетплейсах *Wildberries* и *Ozon*. Он собирает данные о наличии рич-контента для товаров, проверяет остатки вложенных артикулов и обновляет информацию в Google Sheets. Также сервис публикует события при обнаружении нулевых остатков вложенных артикулов.

## Функциональные возможности

- **Отслеживание рич-контента**: Проверка наличия рич-контента для товаров на Wildberries и Ozon.
- **Сбор данных о товарах**: Получение информации о товарах и их остатках через API маркетплейсов.
- **Обновление Google Sheets**: Автоматическое обновление таблиц с данными о рич-контенте, категориях и заметках.
- **Публикация событий**: Уведомление о нулевых остатках вложенных артикулов через Google Cloud Pub/Sub.
- **Асинхронная обработка**: Эффективная работа с API маркетплейсов и базой данных MongoDB.

## Начало работы

Вы можете запустить сервис локально или с использованием Docker. Следуйте приведенным ниже инструкциям для начала работы.

### Запуск локально

1. **Копирование и настройка переменных окружения**:

   - Скопируйте файл окружения-примера `.env-example` в `.env`:
      ```bash
      cp .env-example .env
     ```
   
    - Замените переменные в файле .env на ваши собственные данные (например, API-ключи для Ozon и Wildberries, настройки MongoDB и Google Cloud).

2. **Установка зависимостей**:

   - Установите зависимости проекта с флагом для разработки:
       ```bash
      poetry install --with dev
     ```

3. **Запуск сервиса**:

   - Запустите основной файл сервиса:
       ```
       python3 main.py
     ```

## Запуск с использованием Docker

1. **Копирование и настройка переменных окружения**:

   - Скопируйте файл окружения-примера .env-example в .env-non-dev:
     ```
     cp .env-example .env-non-dev
     ```

    - Замените переменные в файле .env-non-dev на ваши собственные данные.


2. **Запуск сервиса с использованием Docker**:

    - Соберите и запустите Docker-контейнеры:
        ```
        docker-compose up --build -d
        ```

## Дополнительная информация

- Сервис использует MongoDB для хранения данных о товарах и их остатках. Убедитесь, что переменные окружения для подключения к MongoDB настроены корректно (MONGO_HOST, MONGO_PORT, MONGO_USER, MONGO_PASS, MONGO_DB).

- Для работы с Google Sheets используется авторизация через Google Cloud. Убедитесь, что у вас настроены GOOGLE_APPLICATION_CREDENTIALS и необходимые scopes.

- Сервис интегрирован с Google Cloud Pub/Sub для публикации событий о нулевых остатках вложенных артикулов.