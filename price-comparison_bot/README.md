# Сервис Price Comparison Bot

**Price Comparison Bot** — это Telegram-бот, который позволяет авторизованным пользователям запускать обновление таблиц сравнения цен для юридических лиц "Amodecor" и "Stroy-Otdelka". Бот отправляет события в Google Cloud Pub/Sub, которые инициируют процесс обновления данных.

## Функциональные возможности

- **Запуск проверки цен**: Команды или кнопки для запуска обновления цен для "Amodecor" и "Stroy-Otdelka".
- **Ограничение частоты**: Запуск возможен не чаще одного раза в час для каждого юридического лица.
- **Авторизация**: Доступ ограничен списком разрешенных Telegram ID.
- **Интерфейс**: Простое управление через кнопки и команды Telegram.
- **Публикация событий**: Отправка событий в топик Google Cloud Pub/Sub для обработки на бэкенде.
- **Логирование**: Логи уровня `INFO` для отслеживания действий и ошибок.

## Начало работы

Для запуска бота необходимо настроить окружение, установить зависимости и запустить его локально или в Docker-контейнере.

### Настройка локально

1. **Создание виртуального окружения**:
   Создайте виртуальное окружение с помощью Poetry:
   ```bash
   poetry env use python3.12
   ```
   
   - Активируйте его:
       ```
      poetry shell
      ```
   
2. **Установка зависимостей: Установите зависимости через Poetry:**
    ```
   
   poetry install
   ```
   
3. **Настройка переменных окружения: Скопируйте файл .env-example в .env и заполните его:**
    ```
   cp .env-example .env
   ```
   
4. **Запуск бота: Запустите бота локально:**
    ```
   python main.py
   ```
   
## Запуск в Docker

1. **Сборка Docker-образа: Соберите образ из Dockerfile:**
    ```
   docker build -t price-comparison-bot .
   ```

2. **Запуск контейнера: Запустите контейнер, монтируя конфигурацию Google Cloud и .env:**
    ```
   docker run -d \
    --name price-comparison-bot \
    -v ~/.config/gcloud:/root/.config/gcloud \
    --env-file .env \
    price-comparison-bot
   ```
   
3. **Просмотр логов: Проверьте логи контейнера:**
    ```
   docker logs price-comparison-bot
   ```
   
## Дополнительная информация
**Команды бота:**
- /start: Запуск бота и отображение кнопок управления.
- /check_amo: Запуск проверки цен для "Amodecor".
- /check_so: Запуск проверки цен для "Stroy-Otdelka".

**Кнопки:**
- "Запустить AMO": Аналог /check_amo.
- "Запустить SO": Аналог /check_so.